# 채팅 — UX 플로우

유저가 AI 페르소나와 채팅방에서 한국어로 대화하는 여정.

---

## 전체 플로우

```
[앱 진입]
    │
    ▼
[채팅 목록 화면]
  - 대화 중인 AI 페르소나 목록
  - 각 항목: 이름, 마지막 메시지, 시간, 읽지 않은 메시지 수
    │
    ├─ [AI가 먼저 연락] ──→ 푸시 알림 배지 표시
    │
    ▼
[채팅방 진입]
  - 페르소나 이름 + 관계 정보 상단 표시
  - 메시지 히스토리 스크롤
    │
    ▼
[메시지 입력]
  - 유저가 한국어 또는 모국어로 타이핑
    │
    ├─ [오류 감지] ──→ 맥락 안에서 부드럽게 정정 ("그건 '저는'이라고 해요~")
    │
    ▼
[AI 응답 대기]
  - "입력 중..." 인디케이터 표시
  - 지연 적용: 최소 5분 ~ 상황에 따라 무응답
    │
    ├─ [즉시 응답] ──→ 메시지 말풍선 표시
    ├─ [지연 응답] ──→ 시간 경과 후 메시지 도착
    └─ [무응답]    ──→ 바쁨 상태 아이콘 표시
    │
    ▼
[관계 변화 이벤트] (선택적)
  - 친밀도 증가 → 반말 전환
  - 서운함 → 대화방 퇴장
  - 오래 연락 없음 → AI 선발신
    │
    ▼
[채팅 목록으로 복귀]
```

---

## 화면 상태

| 상태 | 설명 |
|------|------|
| `idle` | 채팅 목록 표시 중 |
| `in-chat` | 특정 페르소나와 채팅 중 |
| `waiting` | AI 응답 지연 중 |
| `notification` | AI 먼저 연락 — 알림 배지 |
| `relationship-event` | 관계 변화 이벤트 발생 |

---

## 분기 조건

- **AI 지연 여부**: 페르소나 상태(바쁨/한가함) + 랜덤 딜레이
- **오류 정정 트리거**: 유저 입력에 문법 오류 감지 시
- **관계 이벤트 트리거**: 친밀도 점수 임계값 도달 시
