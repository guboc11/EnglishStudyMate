# 복습 v2 — Flow

유저: Alex (외국인, 한국 도착 3주차)
배경: 강의·채팅·시험을 통해 단어가 쌓이기 시작. 간격 반복 복습 시작.

---

## 화면 구조

```
┌─────────────────────┐
│     핸드폰 프레임    │
│  (375×812, 세로)    │
└─────────────────────┘
┌────┬────┬───┬───┬───┬───┬───┐
│🗂️  │ 🔔 │ ① │ ② │ ③ │ ④ │ ⑤ │
│카드함│알림│복1│복2│복3│복4│복5│
└────┴────┴───┴───┴───┴───┴───┘
```

탭 7개, 폰 프레임 아래 외부 배치 (LecturePrototypeV2 동일 패턴)

---

## 간격 반복 스케줄

| 단계 | 인터벌 | 복습 모드 |
|-----|--------|---------|
| 1   | 10분   | 단어→뜻 (복습1) |
| 2   | 1시간  | 단어→뜻 (복습1) |
| 3   | 6시간  | 문장→뜻 (복습2) |
| 4   | 1일    | 뜻→단어 (복습3) |
| 5   | 3일    | 뜻→단어 (복습3) |
| 6   | 1주    | 4지선다 (복습4) |
| 7   | 2주    | 4지선다 (복습4) |
| 8   | 3주    | 받아쓰기 (복습5) |
| 9   | 4주    | 받아쓰기 (복습5) |

실패 시: 같은 인터벌 유지 (성공할 때까지 반복), 다음 단계로 진급하지 않음

---

## 탭 1 — 카드함 (🗂️)

### 섹션 A — 수동 추가

```
단어: [____________]
뜻:   [____________]
                [추가하기]
```

### 섹션 B — AI 추천 (Q&A에서 추출)

```
💡 AI가 질문에서 추출했어요

끝내주다  awesome / amazing  [추가 ✓] [건너뛰기]
갑분싸   sudden mood kill   [추가 ✓] [건너뛰기]
```

- [추가 ✓] 탭 시 → stage 1로 이동
- [건너뛰기] 탭 시 → 목록에서 제거

### 섹션 C — 단계별 카드 목록

단계 1~9 각각 헤더 표시:

```
1단계 · 10분 뒤  (3장)
┌─ 눈치  #회화  "다음 복습: 8분 후"
┌─ 끝내주다  #슬랭  "다음 복습: 10분 후"
...

2단계 · 1시간 뒤  (2장)
...

6단계 · 1주 뒤  (1장)
...
```

시각적 depth: 각 단계 헤더 아래 쌓인 카드 더미 (FlashCardScreen 동일 패턴 — rotate 카드 2장 뒤에 배치)

### 인터랙션

- 단계 헤더 탭 → 펼치기/접기
- 카드 항목 탭 → 해당 복습 모드 탭으로 이동

---

## 탭 2 — 알림 (🔔)

### 진입 상태

락스크린 스타일 (bg-gray-900), 7개 알림 스크롤 표시

### 알림 데이터

| 단어 | 뜻 | 단계 | 시간 | 태그 |
|------|----|------|------|------|
| 눈치 | reading the room / social awareness | 1 | 10분 전 | 회화 |
| 처녀 | unmarried young woman | 2 | 45분 전 | 고전 |
| 동사무소 | community service center | 6 | 2분 전 | 행정 |
| 끝내주다 | awesome / amazing | 1 | 15분 전 | 슬랭 |
| 그러니까 | so / that's what I mean | 5 | 1시간 전 | 회화 |
| 세탁기 | washing machine | 5 | 3시간 전 | 생활 |
| 갑분싸 | sudden mood kill | 4 | 어제 | 슬랭 |

### 단계 배지 색상

- 1단계: sky (파랑)
- 2단계: amber (노랑)
- 3단계: emerald (초록)
- 4단계+: violet (보라)

### 인터랙션

- 상단 요약 헤더: "🔔 오늘 7개 복습 예정"
- `overflow-y-auto` 스크롤
- 알림 탭 시: 해당 단어의 복습 모드 탭으로 이동 (토스트: "복습을 시작해요!")

---

## 탭 3 — 복습1 (1️⃣) — 단어 flash → 뜻 입력

### 메커니즘

1. **idle**: 카드 미리보기 + [시작 ▶] 버튼
2. **show-word** (500ms): 단어 큰 글씨 표시 + 하단 진행 바
3. **blank** (1500ms): 흰 화면 "기억나요? ✏️"
4. **input** (10초 제한): 텍스트 인풋 + 카운트다운 + [제출] 버튼
   - 시간 초과 시 자동 fail
5. **result**: 성공/실패 + 정답 표시 + 다음 인터벌 안내

### 레이아웃

```
⚡ 복습 1단계 · 단어→뜻
━━━━━━━━━━━━━━ (타이머 바)

[단어: 끝내주다]   ← 0.5초 후 사라짐
     ↓
  기억나요? ✏️

[___________________]  8... (카운트다운)
              [제출]
```

---

## 탭 4 — 복습2 (2️⃣) — 문장 컨텍스트 → 뜻 입력

### 메커니즘

1. **idle**: 예문 미리보기 + [시작 ▶]
2. **show-sentence**: 예문 표시, 핵심 단어 bold + underline
3. **input** (15초 제한): 텍스트 인풋 + 카운트다운
4. **result**: 성공/실패

### 레이아웃

```
📖 복습 3단계 · 문장→뜻

"눈치가 없으면
 한국 생활이 힘들어."

밑줄 친 '눈치'의 뜻은?
[___________________]  13... (카운트다운)
              [제출]
```

---

## 탭 5 — 복습3 (3️⃣) — 뜻 → 단어 입력

### 메커니즘

1. **idle**: 뜻 미리보기 + [시작 ▶]
2. **show-meaning** (500ms): 영문 뜻 표시
3. **blank** (1500ms): 흰 화면 "한국어로 써보세요 ✏️"
4. **input** (10초 제한): 한글 인풋 + 카운트다운
5. **result**: 성공/실패

### 레이아웃

```
🔄 복습 4단계 · 뜻→단어

[뜻: awesome / amazing]   ← 0.5초 후 사라짐
         ↓
  한국어로 써보세요 ✏️

[___________________]  9... (카운트다운)
              [제출]
```

---

## 탭 6 — 복습4 (4️⃣) — 4지선다 ★

### 메커니즘

1. **idle**: 카드 미리보기 + [시작 ▶]
2. **show-word** (1000ms): 단어 1초 표시
3. **choices**: 뜻 4가지 버튼 (정답 1 + 오답 3, 다른 카드 meanings에서 랜덤)
   - 타이머 없음 (인식 테스트는 압박 없이)
4. **result**: 선택 항목 색상 강조 (✅ 초록 / ❌ 빨강 + 정답 초록)

### 레이아웃

```
🎯 복습 6단계 · 4지선다

[단어: 동사무소]   ← 1초 표시

뜻을 고르세요:

○ washing machine
○ sudden mood kill
● community service center  ← 정답
○ so / that's what I mean
```

---

## 탭 7 — 복습5 (5️⃣) — 받아쓰기 ★

### 메커니즘

1. **idle**: 카드 미리보기 + [시작 ▶]
2. **playing** (2초): 🔊 아이콘 + waveBar 애니메이션 시뮬레이션, 힌트(음절 수 마스킹)
3. **input** (15초 제한): 한글 인풋 + 카운트다운
4. **result**: 성공/실패 + 전체 단어 표시

### 레이아웃

```
🔊 복습 8단계 · 받아쓰기

     🔊
  〰〰〰〰〰〰  (waveBar 애니메이션)

힌트: _ _ _내_ _ _다

[___________________]  12... (카운트다운)
              [제출]
```

---

## 상태 흐름

```
카드함(🗂️)
  → AI 추천 [추가 ✓]
    → stage 1 이동
      → 알림(🔔) 도착
        → 복습1~5 중 해당 단계 탭 진입
          → 성공 → 다음 단계 진급
          → 실패 → 동일 인터벌 재시도
```

---

## 기술 메모

- 패턴: LecturePrototypeV2와 동일한 phone frame + 외부 탭
- 타이머: `useEffect` + `setInterval` 1초 감소 (`useRef`로 interval ID 관리)
- 상태 머신: `type ReviewPhase = "idle" | "show" | "blank" | "input" | "choices" | "result"`
- waveBar: `LecturePrototypeV2.tsx` CSS `@keyframes waveBar` 재사용 (복습5 🔊 연출)
- 알림 카드: `FlashCardReview.tsx` `NotificationScreen` UI 재활용, `overflow-y-auto` 추가
- stageMeta: `FlashCardReview.tsx` 기존 1~3단계 + 4~9단계 색상 확장
- Sonner Toaster: `offset={56}` 동일
- 라우트: `/prototype/v2/review`
